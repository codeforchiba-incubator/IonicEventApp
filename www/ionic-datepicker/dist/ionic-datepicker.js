"use strict";var app=angular.module("ionic-datepicker",["ionic","ionic-datepicker.templates"]);app.service("DatepickerService",function(){this.monthsList=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],this.yearsList=[2015,2016]}),app.directive("ionicDatepicker",["$ionicPopup","DatepickerService",function(e,t){return{restrict:"AE",replace:!0,scope:{ipDate:"=idate",disablePreviousDates:"=disablepreviousdates",callback:"=callback"},link:function(a,n,o){var i=t.monthsList;a.monthsList=i,a.yearsList=t.yearsList,a.currentMonth="",a.currentYear="",a.ipDate||(a.ipDate=new Date),a.previousDayEpoch=+new Date-864e5;var r=angular.copy(a.ipDate);r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),a.selctedDateString=r.toString(),a.weekNames=["日","月","火","水","木","金","土"],a.today={};var s=new Date,c=new Date(s.getFullYear(),s.getMonth(),s.getDate());a.today={dateObj:s,date:c.getDate(),month:c.getMonth(),year:c.getFullYear(),day:c.getDay(),dateString:c.toString(),epochLocal:c.getTime(),epochUTC:c.getTime()+60*c.getTimezoneOffset()*1e3};var l=function(e){e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),a.selctedDateString=new Date(e).toString(),r=angular.copy(e);var t=new Date(e.getFullYear(),e.getMonth(),1).getDate(),n=new Date(e.getFullYear(),e.getMonth()+1,0).getDate();a.dayList=[];for(var o=t;n>=o;o++){var s=new Date(e.getFullYear(),e.getMonth(),o);a.dayList.push({date:s.getDate(),month:s.getMonth(),year:s.getFullYear(),day:s.getDay(),dateString:s.toString(),epochLocal:s.getTime(),epochUTC:s.getTime()+60*s.getTimezoneOffset()*1e3})}var t=a.dayList[0].day;a.currentMonthFirstDayEpoch=a.dayList[0].epochLocal;for(var c=0;t>c;c++)a.dayList.unshift({});a.rows=[],a.cols=[],a.currentMonth=i[e.getMonth()],a.currentYear=e.getFullYear(),a.numColumns=7,a.rows.length=6,a.cols.length=a.numColumns};a.monthChanged=function(e){var t=a.monthsList.indexOf(e);r.setMonth(t),l(r)},a.yearChanged=function(e){r.setFullYear(e),l(r)},a.prevMonth=function(){1===r.getMonth()&&r.setFullYear(r.getFullYear()),r.setMonth(r.getMonth()-1),a.currentMonth=i[r.getMonth()],a.currentYear=r.getFullYear(),l(r)},a.nextMonth=function(){11===r.getMonth()&&r.setFullYear(r.getFullYear()),r.setMonth(r.getMonth()+1),a.currentMonth=i[r.getMonth()],a.currentYear=r.getFullYear(),l(r)},a.date_selection={selected:!1,selectedDate:"",submitted:!1},a.dateSelected=function(e){a.selctedDateString=e.dateString,a.date_selection.selected=!0,a.date_selection.selectedDate=new Date(e.dateString)},n.on("click",function(){if(a.ipDate)l(angular.copy(a.ipDate));else{var t=new Date;l(t)}e.show({templateUrl:"date-picker-modal.html",title:"<strong>日にちの選択</strong>",subTitle:"",scope:a,buttons:[{text:"今日",onTap:function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),o={date:t.getDate(),month:t.getMonth(),year:t.getFullYear(),day:t.getDay(),dateString:t.toString(),epochLocal:n.getTime(),epochUTC:n.getTime()+60*n.getTimezoneOffset()*1e3};a.selctedDateString=o.dateString,a.date_selection.selected=!0,a.date_selection.selectedDate=new Date(o.dateString),l(new Date),e.preventDefault()}},{text:"設定",type:"button-positive",onTap:function(e){if(a.date_selection.submitted=!0,a.date_selection.selected===!0)try{a.callback(a.date_selection.selectedDate),a.ipDate=angular.copy(a.date_selection.selectedDate)}catch(t){}else e.preventDefault()}}]})})}}}]);